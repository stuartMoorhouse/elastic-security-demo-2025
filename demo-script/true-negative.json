{
  "@timestamp": "2025-11-10T15:35:18.224Z",
  "agent": {
    "id": "c2d3e4f5-a6b7-8901-cdef-234567890abc",
    "type": "endpoint",
    "version": "9.0.5"
  },
  "data_stream": {
    "dataset": "endpoint.events.process",
    "namespace": "default",
    "type": "logs"
  },
  "ecs": {
    "version": "8.10.0"
  },
  "event": {
    "action": "exec",
    "agent_id_status": "verified",
    "category": "process",
    "created": "2025-11-10T15:35:18.227Z",
    "dataset": "endpoint.events.process",
    "id": "ZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoxMjM0",
    "ingested": "2025-11-10T15:35:20.000Z",
    "kind": "event",
    "module": "endpoint",
    "outcome": "success",
    "sequence": 9123001,
    "type": "start"
  },
  "group": {
    "Ext": {
      "real": {
        "id": "1000",
        "name": "ubuntu"
      }
    },
    "id": "1000",
    "name": "ubuntu"
  },
  "host": {
    "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "name": "blue-01",
    "os": {
      "type": "linux"
    }
  },
  "message": "Endpoint process event",
  "process": {
    "args": ["ls", "-la", "/opt/elasticsearch/logs"],
    "args_count": 3,
    "command_line": "ls -la /opt/elasticsearch/logs",
    "entity_id": "bHMtcHJvY2Vzcy1lbnRpdHktaWQ=",
    "executable": "/usr/bin/ls",
    "hash": {
      "sha256": "9e2b5c8d3c7c7c0f7e5c5e3c0b5c7c0e3e3c0e5c7c0e3e3c0e5c7c0e3e3c0e5c"
    },
    "name": "ls",
    "parent": {
      "args": [
        "/usr/share/elasticsearch/jdk/bin/java",
        "-Xshare:auto",
        "-Des.networkaddress.cache.ttl=60",
        "-Des.networkaddress.cache.negative.ttl=10",
        "-Djava.security.manager=allow",
        "-XX:+AlwaysPreTouch",
        "-Xss1m",
        "-Djava.awt.headless=true",
        "-Dfile.encoding=UTF-8",
        "-Djna.nosys=true",
        "-XX:-OmitStackTraceInFastThrow",
        "-Dio.netty.noUnsafe=true",
        "-Dio.netty.noKeySetOptimization=true",
        "-Dlog4j.shutdownHookEnabled=false",
        "-Dlog4j2.disable.jmx=true",
        "-Dlog4j2.formatMsgNoLookups=true",
        "-Djava.locale.providers=SPI,COMPAT",
        "-Xms4g",
        "-Xmx4g",
        "-XX:+UseG1GC",
        "-Djava.io.tmpdir=/tmp/elasticsearch",
        "-XX:+HeapDumpOnOutOfMemoryError",
        "-XX:HeapDumpPath=/var/lib/elasticsearch",
        "-XX:ErrorFile=/var/log/elasticsearch/hs_err_pid%p.log",
        "-Xlog:gc*,gc+age=trace,safepoint:file=/var/log/elasticsearch/gc.log:utctime,pid,tags:filecount=32,filesize=64m",
        "-Des.cgroups.hierarchy.override=/",
        "-Xmx4g",
        "-Xms4g",
        "-XX:MaxDirectMemorySize=2147483648",
        "-Des.path.home=/usr/share/elasticsearch",
        "-Des.path.conf=/etc/elasticsearch",
        "-Des.distribution.type=deb",
        "-Des.bundled_jdk=true",
        "-cp",
        "/usr/share/elasticsearch/lib/*",
        "org.elasticsearch.bootstrap.Elasticsearch"
      ],
      "args_count": 35,
      "command_line": "/usr/share/elasticsearch/jdk/bin/java -Xshare:auto -Des.networkaddress.cache.ttl=60 -Des.networkaddress.cache.negative.ttl=10 -Djava.security.manager=allow -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djna.nosys=true -XX:-OmitStackTraceInFastThrow -Dio.netty.noUnsafe=true -Dio.netty.noKeySetOptimization=true -Dlog4j.shutdownHookEnabled=false -Dlog4j2.disable.jmx=true -Dlog4j2.formatMsgNoLookups=true -Djava.locale.providers=SPI,COMPAT -Xms4g -Xmx4g -XX:+UseG1GC -Djava.io.tmpdir=/tmp/elasticsearch -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/lib/elasticsearch -XX:ErrorFile=/var/log/elasticsearch/hs_err_pid%p.log -Xlog:gc*,gc+age=trace,safepoint:file=/var/log/elasticsearch/gc.log:utctime,pid,tags:filecount=32,filesize=64m -Des.cgroups.hierarchy.override=/ -Xmx4g -Xms4g -XX:MaxDirectMemorySize=2147483648 -Des.path.home=/usr/share/elasticsearch -Des.path.conf=/etc/elasticsearch -Des.distribution.type=deb -Des.bundled_jdk=true -cp /usr/share/elasticsearch/lib/* org.elasticsearch.bootstrap.Elasticsearch",
      "entity_id": "ZWxhc3RpY3NlYXJjaC1qYXZhLXBhcmVudA==",
      "executable": "/usr/share/elasticsearch/jdk/bin/java",
      "name": "java",
      "pid": 3456,
      "start": "2025-11-10T08:22:15.456Z",
      "user": {
        "id": "1000",
        "name": "ubuntu"
      },
      "working_directory": "/opt/elasticsearch"
    },
    "pid": 9123,
    "start": "2025-11-10T15:35:18.224Z",
    "working_directory": "/opt/elasticsearch"
  },
  "user": {
    "Ext": {
      "real": {
        "id": "1000",
        "name": "ubuntu"
      }
    },
    "id": "1000",
    "name": "ubuntu"
  }
}
